"use strict";(self.webpackChunkencuestas_app=self.webpackChunkencuestas_app||[]).push([[451],{3451:(O,m,s)=>{s.r(m),s.d(m,{EncuestadoModule:()=>Q});var d=s(6895),l=s(3158),a=s(433),e=s(8256),f=s(4621),p=s(5002),g=s(4004),v=s(262),_=s(9646);let h=(()=>{class t{constructor(n){this.encuestadoService=n}validate(n){return n.value?this.encuestadoService.verificarEncuestado(n.value).pipe((0,g.U)(i=>i?{resultado:!0}:null),(0,v.K)(()=>(0,_.of)(null))):new Promise(null)}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(p.h))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Z=s(8168);function E(t,o){1&t&&(e.TgZ(0,"small",25),e._uU(1,"No puedes volver a llenar la encuesta"),e.qZA())}function x(t,o){1&t&&(e.TgZ(0,"small",25),e._uU(1,"Este campo es obligatorio"),e.qZA())}function C(t,o){1&t&&(e.TgZ(0,"small",25),e._uU(1,"Este campo es obligatorio."),e.qZA())}function T(t,o){1&t&&(e.TgZ(0,"small",25),e._uU(1,"Este campo es obligatorio."),e.qZA())}function z(t,o){if(1&t&&(e.TgZ(0,"option",26),e._uU(1),e.qZA()),2&t){const n=o.$implicit;e.Q6J("value",n.nombre),e.xp6(1),e.Oqu(n.nombre)}}function A(t,o){1&t&&(e.TgZ(0,"small",25),e._uU(1,"Este campo es obligatorio."),e.qZA())}function I(t,o){if(1&t&&(e.TgZ(0,"div",12)(1,"fieldset"),e._uU(2,"Complete este formulario antes de comenzar"),e.qZA(),e.YNc(3,E,2,0,"small",13),e.TgZ(4,"div",14)(5,"label",15),e._uU(6,"Identificacion"),e.qZA(),e._UZ(7,"input",16),e.YNc(8,x,2,0,"small",13),e.qZA(),e.TgZ(9,"div",17)(10,"label",15),e._uU(11,"Nombre completo"),e.qZA(),e._UZ(12,"input",18),e.YNc(13,C,2,0,"small",13),e.qZA(),e.TgZ(14,"div",17)(15,"label",15),e._uU(16,"Email"),e.qZA(),e._UZ(17,"input",19),e.YNc(18,T,2,0,"small",13),e.qZA(),e.TgZ(19,"div",17)(20,"label",15),e._uU(21,"Seleccionar grupo "),e.qZA(),e.TgZ(22,"select",20)(23,"option",21),e._uU(24,"Seleccionar"),e.qZA(),e.YNc(25,z,2,2,"option",22),e.qZA(),e.YNc(26,A,2,0,"small",13),e.qZA(),e.TgZ(27,"div",23)(28,"button",24),e._uU(29,"Continuar"),e.qZA()()()),2&t){const n=e.oxw(2);e.xp6(3),e.Q6J("ngIf",n.existeEncuestado()),e.xp6(5),e.Q6J("ngIf",n.validarCampoGeneral("identificacion")),e.xp6(5),e.Q6J("ngIf",n.validarCampoGeneral("nombre")),e.xp6(5),e.Q6J("ngIf",n.validarCampoGeneral("email")),e.xp6(7),e.Q6J("ngForOf",n.encuesta.grupos),e.xp6(1),e.Q6J("ngIf",n.validarCampoGeneral("carrera"))}}function b(t,o){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ( ",n.valor,")")}}function q(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"ul",30)(1,"div",31)(2,"input",32),e.NdJ("change",function(r){e.CHM(n);const u=e.oxw().$implicit,c=e.oxw(3);return e.KtG(c.radioChangeHandler(r,u.codigo))}),e.qZA(),e.TgZ(3,"label",33),e.YNc(4,b,2,1,"span",9),e._uU(5),e.qZA()()()}if(2&t){const n=o.$implicit,i=e.oxw().$implicit;e.xp6(2),e.Q6J("value",n.id)("name",i.codigo),e.xp6(2),e.Q6J("ngIf",0!==n.valor),e.xp6(1),e.hij(" - ",n.descripcion," ")}}function N(t,o){if(1&t&&(e.TgZ(0,"div",2)(1,"div",17)(2,"label",15),e._uU(3),e.qZA(),e.YNc(4,q,6,4,"ul",29),e.qZA()()),2&t){const n=o.$implicit;e.xp6(3),e.Oqu(n.titulo),e.xp6(1),e.Q6J("ngForOf",n.opciones)}}function R(t,o){if(1&t&&(e.TgZ(0,"div")(1,"div",27),e.YNc(2,N,5,2,"div",28),e.qZA(),e.TgZ(3,"div",23)(4,"button",24),e._uU(5,"Continuar"),e.qZA()()()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",null==n.encuesta?null:n.encuesta.preguntas)}}function U(t,o){if(1&t&&(e.TgZ(0,"section"),e.YNc(1,I,30,6,"div",11),e.YNc(2,R,6,1,"div",9),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",1==n.step),e.xp6(1),e.Q6J("ngIf",2==n.step)}}function F(t,o){1&t&&(e.TgZ(0,"div",34),e._uU(1," La encuesta no se encuentra disponible "),e.qZA())}function J(t,o){1&t&&(e.TgZ(0,"div",34),e._uU(1," La encuesta ha finalizado. "),e.qZA())}const w=[{path:"finalizado",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-finalizado"]],decls:6,vars:0,consts:[[1,"container","my-5"],[1,"p-5","text-center","bg-body-tertiary","rounded-3"],[1,"text-body-emphasis"],[1,"lead"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),e._uU(3,"Gracias por finalizar la encuesta"),e.qZA(),e.TgZ(4,"p",3),e._uU(5," Agradecemos tu participacion las respuestas han sido guardadas en nuestro sistema. "),e.qZA()()())}}),t})()},{path:":hash",component:(()=>{class t{constructor(n,i,r,u,c){this.encuestaService=n,this.activateRouter=i,this.encuestadoService=r,this.router=u,this.encuestadoValidator=c,this.encuesta={titulo:"",descripcion:""},this.step=1,this.hash="",this.terminado=!1,this.formSubmit=!1,this.formEncuestado=new a.cw({encuestado:new a.cw({identificacion:new a.NI("",[a.kI.required],this.encuestadoValidator.validate.bind(this.encuestadoValidator)),nombre:new a.NI("",a.kI.required),carrera:new a.NI("",a.kI.required),idEncuesta:new a.NI("",a.kI.required),email:new a.NI("",a.kI.required)}),idEncuesta:new a.NI("",a.kI.required),respuestas:new a.Oe([],a.kI.required)}),this.hash=this.activateRouter.snapshot.params.hash}ngOnInit(){this.obtenerEncuesta()}get respuestas(){return this.formEncuestado.get("respuestas")}guardarRespuesta(n,i){this.actualizarRespuesta(this.respuestas.value,n,"opcion",i)||this.respuestas.push(new a.cw({idPregunta:new a.NI(n,a.kI.required),opcion:new a.NI(i,a.kI.required)}))}obtenerEncuesta(){this.encuestaService.obtenerEncuestasPorhash(this.hash).subscribe(n=>{this.encuesta=n,this.verificarFechaDeCierre(this.encuesta),this.formEncuestado.controls.encuestado.get("idEncuesta").setValue(n.id),this.formEncuestado.controls.idEncuesta.setValue(n.id)})}enviarEncuesta(){if(this.step<=2){if(this.formEncuestado.controls.encuestado.invalid&&1==this.step)return void(this.formSubmit=!0);if(2==this.step){if(this.formEncuestado.controls.respuestas.invalid&&2==this.step)return void(this.formSubmit=!0);this.encuestadoService.guardarRespuestas(this.formEncuestado.value).subscribe(n=>{n&&this.router.navigateByUrl("/realizar-encuesta/finalizado")})}else this.step=this.step+1}}radioChangeHandler(n,i){this.guardarRespuesta(i,n.target.value)}validarCampoGeneral(n){return!(!this.formEncuestado.controls.encuestado.get(n).invalid||!this.formSubmit)}actualizarRespuesta(n,i,r,u){const c=n.find(S=>S.idPregunta==i);return null!=c&&(c[r]=u,!0)}verificarFechaDeCierre(n){new Date(n.fechaFinal).getTime()>Date.now()?this.terminado=!1:(this.terminado=!0,console.log("finalizado"))}existeEncuestado(){return null!=this.formEncuestado.controls.encuestado.get("identificacion").errors&&this.formEncuestado.controls.encuestado.get("identificacion")?.errors.resultado}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f.Y),e.Y36(l.gz),e.Y36(p.h),e.Y36(l.F0),e.Y36(h))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-realizar-encuesta"]],decls:14,vars:6,consts:[[1,"container"],[1,"row","pt-5"],[1,"col-md-12"],[1,"col-md-6","mx-auto"],[1,"d-flex","justify-content-center"],[1,"logo"],[1,"text-center","pt-2"],[1,"text-center"],["autocomplete","off",3,"formGroup","submit"],[4,"ngIf"],["class","alert alert-warning","role","alert",4,"ngIf"],["formGroupName","encuestado",4,"ngIf"],["formGroupName","encuestado"],["class","text-danger",4,"ngIf"],[1,"mb-3","mt-3"],["for",""],["type","text","formControlName","identificacion",1,"form-control"],[1,"mb-3"],["type","text","formControlName","nombre",1,"form-control"],["type","text","formControlName","email",1,"form-control"],["name","","id","","formControlName","carrera",1,"form-control"],["value","","selected","true"],[3,"value",4,"ngFor","ngForOf"],[1,"mb-5"],["type","submit",1,"button","button-primary"],[1,"text-danger"],[3,"value"],[1,"row","justify-content-center","mx-auto"],["class","col-md-12",4,"ngFor","ngForOf"],["class","mt-2",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"form-check"],["type","radio",1,"form-check-input",3,"value","name","change"],["for","flexRadioDefault1",1,"form-check-label"],["role","alert",1,"alert","alert-warning"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e._UZ(5,"app-logo",5),e.qZA(),e.TgZ(6,"h3",6),e._uU(7),e.qZA(),e.TgZ(8,"p",7),e._uU(9),e.qZA(),e.TgZ(10,"form",8),e.NdJ("submit",function(){return i.enviarEncuesta()}),e.YNc(11,U,3,2,"section",9),e.YNc(12,F,2,0,"div",10),e.YNc(13,J,2,0,"div",10),e.qZA()()()()()),2&n&&(e.xp6(7),e.hij(" ",i.encuesta.titulo," "),e.xp6(2),e.Oqu(i.encuesta.descripcion),e.xp6(1),e.Q6J("formGroup",i.formEncuestado),e.xp6(1),e.Q6J("ngIf",i.encuesta.estado&&!i.terminado),e.xp6(1),e.Q6J("ngIf",!i.encuesta.estado),e.xp6(1),e.Q6J("ngIf",i.terminado))},dependencies:[d.sg,d.O5,Z.R,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u,a.x0]}),t})()}];let y=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[l.Bz.forChild(w),l.Bz]}),t})();var Y=s(4466);let Q=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[d.ez,y,Y.m,a.UX]}),t})()}}]);